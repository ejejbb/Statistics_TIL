# 통계학 5주차 정규과제

📌통계학 정규과제는 매주 정해진 분량의 『*데이터 분석가가 반드시 알아야 할 모든 것*』 을 읽고 학습하는 것입니다. 이번 주는 아래의 **Statistics_5th_TIL**에 나열된 분량을 읽고 `학습 목표`에 맞게 공부하시면 됩니다.

아래의 문제를 풀어보며 학습 내용을 점검하세요. 문제를 해결하는 과정에서 개념을 스스로 정리하고, 필요한 경우 추가자료와 교재를 다시 참고하여 보완하는 것이 좋습니다.

5주차는 `3부-12.통계 기반 분석 방법론`를 읽고 새롭게 배운 내용을 정리해주시면 됩니다.

[실습코드](https://github.com/c-karl/DA_DS_Book001)를 참고하여 학습해주세요.

### 추가자료
---
[PCA](https://youtu.be/nEvKduLXFvk?si=3boneV3nAQe-OoU4)


## Statistics_5th_TIL

### 3부. 데이터 분석 준비하기
### 12.통계 기반 분석 방법론



## Study Schedule

|주차 | 공부 범위     | 완료 여부 |
|----|--------------|----------|
|1주차| 1부 ~p.79    | ✅      |
|2주차| 2부 ~p.120   | ✅      | 
|3주차| 2부 ~p.202   | ✅      | 
|4주차| 2부 ~p.299   | ✅      | 
|5주차| 3부 ~p.356   | ✅      | 
|6주차| 3부 ~p.437   | 🍽️      | 
|7주차| 3부 ~p.542   | 🍽️      | 
|8주차| 3부 ~p.615   | 🍽️      | 
|9주차|데이터 분석 실습| 🍽️      |

<!-- 여기까진 그대로 둬 주세요-->

# 12.통계 기반 분석 방법론

```
✅ 학습 목표 :
* 차원 축소 기법(PCA, CFA)을 이해하고 활용할 수 있다.
* 다중공선성을 확인하고 해결하는 방법을 이해하며, 회귀 분석에서 변수 간 상관성을 줄이는 방법을 설명할 수 있다.
* Z-TEST와 T-TEST의 개념과 차이를 이해하고, 적절한 상황에서 검정을 설계하고 수행할 수 있다.
* ANOVA TEST를 활용하여 세 개 이상의 그룹 간 평균 차이를 검정하고, 사후검정을 수행할 수 있다.
* 카이제곱 검정을 통해 범주형 변수 간의 독립성과 연관성을 분석하는 방법을 설명할 수 있다.
```
<!-- 새롭게 배운 내용을 자유롭게 정리해주세요.-->

### 12.1. 분석 모델 개요

![방법](/img/5.1.jpg)   
![방법](/img/5.2.jpg)

기계 학습 데이터 분석 방법론은 종속변수의 유무에 따라 크게 지도학습과 비지도학습으로 나눌 수 있다.

지도학습은 입력에 대한 정답이 주어져서 출력된 결괏값과 정답 사이의 오차가 줄어들도록 학습과 모델 수정을 반복한다. 결괏값이 양적 척도면 회귀 방식, 질적 척도면 분류 방식을 사용한다.

비지도학습은 별도의 정답이 없어 변수 간 패턴을 파악하거나 데이터를 군집화하는 방법이다. 크게 차원축소, 군집 분석, 연관규칙 세 가지로 구분지을 수 있다. 차원축소는 주로 지도학습을 할 때 학습 성능을 높이기 위한 전처리 방법으로 사용되는 경우가 많다. 군집 분석의 경우 라벨링 없이 유사한 관측치들끼리 군집으로 분류하는 기법이다. 연관규칙은 경영학에서 장바구니 분석으로 잘 알려져 있는데 제품이나 콘텐츠를 추천하기 위해 사용하는 모델이다.

강화학습은 시행착오를 통해 학습하는 과정을 기본 콘셉트로 한 방법 중 하나이다.

### 12.2. 주성분분석(PCA)

PCA는 여러 개의 독립변수들을 잘 설명해 줄 수 있는 주된 성분을 추출하는 기법이다. 주성분 분석을 통해 전체 변수들의 핵심 특성만 선별하기 때문에 독립변수(차원)의 수를 줄일 수 있다. PCA를 하려면 사용되는 변수들이 모두 등간척도나 비율척도로 측정한 **양적변수**여야 하고 관측치들이 서로 **독립**적이고 **정규분포**를 이루고 있어야 한다.

차원을 감소하는 방법은 첫째, 변수 선택을 통해 비교적 불필요하거나 유의성이 낮은 변수를 제거하는 방법이 있고 둘째, 변수들의 잠재적 성분을 추출하여 차원을 줄이는 방법이 있다. PCA와 CFA는 두번째 방법에 속한다. `PCA`는 변수의 수를 축약하면서 **정보의 손실을 최소화**하고자 할 때 사용되며, `CFA`는 변수들 사이에 존재하는 차원을 규명함으로써 **변수들 간 구조를 파악**하는 데 주로 사용된다.

PCA는 다차원의 데이터 분포를 가장 잘 설명해 주는 성분들을 찾아주는데, 데이터 공간에 위치하는 점들의 **분산을 최대한 보존**하는 축을 통해 차원을 축소하는 것이 핵심 요소이다. 그러한 축을 찾기 전에 우선 데이터 표준화를 해준다. 그 다음 데이터의 분산을 가장 잘 나타낼 수 있는 축을 찾아준다. PCA는 처음 변수의 개수만큼 새로운 성분이 나온다. 각 주성분의 설명력은 전체 분산 중 해당 주성분이 가진 분산으로 표현된다.

### 12.3. 공통요인분석(CFA)

```
[PCA]
- 전체 분산을 토대로 요인을 추출
- 전체 독립변수들을 잘 설명해줄 수 있는 주된 성분 두세 개를 *추출*하는 기법
```
```
[CFA]
- 공통 분산만을 토대로 요인을 추출
- 전체 독립변수를 축약한다는 점에서는 PCA와 동일
- 상관성이 높은 변수들을 *묶어* 잠재된 몇 개의 변수를 찾는다는 점에서 PCA와 차이가 있음
- CFA로 생성한 주성분들은 서로 간 무엇이 더 중요한 변수라는 우위 개념이 없음
```

PCA와 CFA와 같은 요인 분석을 하기 위해서는 우선 독립변수들 간 상관성이 요인분석에 적합한지 검증을 해야한다.(방법: 바틀렛 테스트, KMO 검정)

바틀렛 테스트: 행렬식을 이용하여 카이제곱값을 구해 각 변수 사이의 상관계수의 적합성을 검증하는 방법, P-VALUE < 0.05 이면 대각행렬 아님 -> 변수 간 상관관계 있다고 결론 -> 요인 분석 가능

KMO 검정: 변수 간 상관관계가 다른 변수에 의해 잘 설명되는 정도를 통계적으로 검정, KMO 값이 0.8 이상이면 우수, 0.5 이상이면 적합, 0.5 미만이면 부적합.

적합성을 검증한 후에는 요인분석을 통해 생성되는 주성분 변수들의 **고유치**(요인이 설명해 주는 분산의 양)를 확인하여 **요인의 개수**를 결정한다.

요인 수에 따른 고유치 변화를 그래프로 나타낸 *SCREE PLOT*을 확인하여 ELBOW POINT 까지의 요인을 선택한다.

요인 적재 값을 통해 각 변수와 요인 간의 상관관계 정도를 확인할 수 있다. 요인에 대한 판단은 주관적 판단이 들어갈 수밖에 없으므로 주의해서 해석하고 보편적인 상식에서 벗어나지 않게 해야 한다.



### 12.4. 다중공선성 해결과 섀플리 밸류 분석

다중공선성: 독립변수들 간 상관관계가 높은 현상, 두 개 이상의 독립변수가 서로 선형적 관계를 나타낼 때 다중공선성이 있다고 말한다.

다중공선성이 있다 -> 독립변수 독립 가정 위배 -> 회귀분석에서 모델 정합성 맞지 않는 문제 발생

```
[다중공선성을 판별하는 기준]
# 상관분석
 - 회귀 분석 모델 실행 전 수행
 - 0.7 이상이면 두 변수 간 상관성이 높다고 해석
 - 변수가 많을 경우 상관성을 파악하기 힘들다는 단점

# 회귀분석 결과에서 R^2 값은 크지만 회귀계수에 대한 t값이 낮은 경우 다중공선성 의심
 - t값은 해당 변수의 시그널 강도 -> 클수록 좋음

# VIF(분산팽창계수)
 - 해당 변수가 다른 변수들에 의해 설명될 수 있는 정도
 - 1 부터 무한대의 값을 가짐
 - 10 이상이면 다중공선성 있다고 판단
```

```
[다중공선성을 해결하는 방법]
# VIF값이 높은 변수들 중에서 종속변수와의 상관성이 가장 낮은 변수를 제거하고 다시 VIF값을 확인하는 것을 반복

# 표본 관측치를 추가적으로 확보하여 다중공선성을 완화 -> 비현실적

# 변수를 가공하여 변수 간 상관성을 줄이는 방법
 - 해당 값에 로그를 취하거나, 표준화 및 정규화 변환 등
 - 연속형 변수를 구간화 혹은 명목변수로 변환

# PCA
 - 변수 해석이 어려워진다는 단점

# 변수 선택 알고리즘 활용하기
 - 전진 선택법
 - 후진 제거법
 - 단계적 선택법
 - 분석 경험이 적은 분석가가 활용하기에 좋음
```

섀플리 밸류 분석 : 각 독립변수가 종속변수의 설명력에 기여하는 순수한 수치를 계산하는 방법   
    - 변수 각각의 섀플리 밸류 값을 모두 더하면 모든 변수를 투입했을 때의 설명력과 동일하게 나옴.

### 12.5. 데이터 마사지와 블라인드 분석

데이터 마사지:
- 데이터 분석 결과가 예상하거나 의도한 방향과 다를 때 데이터의 배열을 수정하거나 관점을 바꾸는 등 동일한 데이터라도 해석이 달라질 수 있도록 유도하는 것
- 데이터의 수치 자체를 바꾸는 데이터 조작과 차이가 있음
- 지양해야 함

```
[데이터 마사지 방법]
- 편향된 데이터 전처리
- 매직그래프 사용 -> 절대 사용하면 안됨
- 분모 바꾸기 등 관점 변화
- 의도적인 데이터 누락 및 가공
- 머신러닝 모델의 파라미터 값 변경 및 연산반복
- 심슨의 역설
```

블라인드 분석:
- 데이터 마사지에 의한 왜곡을 방지하기 위해 사용하는 방법
- 편향에 의한 오류를 최소화하기 위한 방법
- 블라인드 분석의 목적은 분석가의 부정행위를 막기 위한 것이 아니라 기존에 분석가가 중요하다고 생각했던 변수가 큰 의미 없는 것으로 결과가 나왔을 때 무리해서 의미부여를 하거나 그 변수에 집착하여 해석에 유리하도록 변수를 가공하게 되는 실수를 방지하고자 하는 데에 있다.
- 점검 보조적 수단으로 사용


### 12.6. Z-TEST와 T-TEST

- 집단 내 혹은 집단 간 평균값의 차이가 통계적으로 유의미한 것인지 알아내는 방법
- 분석하고자 하는 변수: 양적 변수, 정규 분포, 등분산
- Z-TEST -> KNOWN VARIANCE / T-TEST -> UNKNOWN VARIANCE
- 표본의 크기가 30 이상이면 중심 극한 정리에 의해 정규분포를 따른다고 볼 수 있으므로 Z-TEST 사용 가능

단일 집단 평균값 차이를 분석하는 경우, 두 집단의 평균 차이를 분석하는 경우, 비율 차이를 비교하는 경우 예시 설명

### 12.7. ANOVA

- 세 집단 이상의 평균을 검정할 때 사용
- F 분포를 사용
- 독립변수: 범주형 변수 / 종속변수: 연속형 변수
```
# 회귀분석 -> 독립변수, 종속변수 모두 연속형
# 교차분석 -> 독립변수, 종속변수 모두 분류형
```
- 각 집단의 평균값 차이가 통계적으로 유의한지 검정
  집단 평균의 분산이 큰 정도를 따져서 집단 간 평균이 다른지를 판별
- '집단 간 평균의 분산 / 집단 내 분산' 값이 임계치를 초과하는가에 따라 집단 간 평균 차이를 검정 -> 초과하면 통계적으로 유의미한 차이가 있다고 판단
- 사후검증: 어떤 집단 간 차이가 있는지 확인
```
[사후검증]
# 각 집단 수가 같다 -> HSD 검증
# 각 집단 수가 다르다 -> Scheffe 검증
```

### 12.8. 카이제곱검정(교차분석)

- 명목 혹은 서열척도와 같은 범주형 변수들 간의 연관성을 분석하기 위해 결합분포를 활용하는 방법
- 상관분석과 달리 연관성의 정도를 수치로 표현할 수 없음
- 카이제곱 통계량을 통해 변수 간 상관성이 있고 없음을 판단


<br>
<br>

# 확인 문제

### **문제 1. 주성분 분석 (PCA)**
> **🧚 아래는 어떤 데이터셋에 대해 주성분 분석(PCA)을 수행한 결과입니다. 결과표를 보고 적절한 차원 축소 개수를 결정해주세요.**

#### **[PCA 결과표]**
| 주성분 | 고유값(Eigenvalue) | 설명된 분산 비율(%) | 누적 설명된 분산 비율(%) |
|--------|-------------------|-------------------|-----------------------|
| PC1    | 4.2               | 42.0%             | 42.0%                 |
| PC2    | 2.8               | 28.0%             | 70.0%                 |
| PC3    | 1.5               | 15.0%             | 85.0%                 |
| PC4    | 0.9               | 9.0%              | 94.0%                 |
| PC5    | 0.6               | 6.0%              | 100.0%                | 

<!--정해진 답은 없습니다. 적절한 근거를 들어 자유롭게 작성해주세요.-->

```
Scree Plot을 그려보면 Elbow Point가 나타나는 PC3까지 사용하는 것이 적절하다. 3개의 주성분을 선택하면 전체 데이터의 85%를 설명할 수 있다.
```
---

### **문제 2.**
> **🧚 경희는 다트비 교육 연구소의 연구원이다. 경희는 이번에 새롭게 개발한 교육 프로그램이 기존 프로그램보다 학습 성취도 향상에 효과적인지 검증하고자 100명의 학생을 무작위로 두 그룹으로 나누어 한 그룹(A)은 새로운 교육 프로그램을, 다른 그룹(B)은 기존 교육 프로그램을 수강하도록 하였다. 8주 후, 학생들의 최종 시험 점수를 수집하여 두 그룹 간 평균 점수를 비교하려 한다.**   

> **🔍 Q1. 이 실험에서 사용할 적절한 검정 방법은 무엇인가요?**

```
독립표본 T-TEST
```

> **🔍 Q2. 이 실험에서 설정해야 할 귀무가설과 대립가설을 각각 작성하세요.**

```
# 귀무가설(H₀): 새로운 교육 프로그램을 수강한 학생들의 평균 점수는 기존 교육 프로그램을 수강한 학생들의 평균 점수와 차이가 없다.  

# 대립가설(H₁): 새로운 교육 프로그램을 수강한 학생들의 평균 점수는 기존 교육 프로그램을 수강한 학생들의 평균 점수보다 높다. → 단측 검정
```

> **🔍 Q3. 검정을 수행하기 위한 절차를 순서대로 서술하세요.**

<!--P.337의 실습 코드 흐름을 확인하여 데이터를 불러온 후부터 어떤 절차로 검정을 수행해야 하는지 고민해보세요.-->

```
(1) 데이터 탐색 
   - 각 그룹(A, B)의 표본 크기 확인  
   - 기술통계량(평균, 표준편차, 최소값, 최대값) 확인  
   - 결측값 확인 및 처리  

(2) 정규성 검정
   - 두 그룹의 점수 분포가 정규성을 만족하는지 확인 (Shapiro-Wilk 검정 또는 Kolmogorov-Smirnov 검정)  

(3) 등분산 검정
   - 두 그룹의 분산이 동일한지 확인 (Levene’s Test 또는 F-test)  
   - 등분산이 만족되지 않으면 Welch’s T-TEST 수행  

(4) 독립표본 T-TEST 수행
   - 유의수준(α) 설정 
   - t-검정 수행 후 p-value 확인  

(5) 결과 해석 및 결론 도출
   - p-value < 0.05 → 귀무가설 기각 (새로운 교육 프로그램이 효과적)  
   - p-value ≥ 0.05 → 귀무가설 채택 (새로운 교육 프로그램의 효과가 유의미하지 않음) 
```

> **🔍 Q4. 이 검정을 수행할 때 가정해야 하는 통계적 조건을 설명하세요.**

```
- 모집단이 정규분포를 따른다 (표본 크기가 30 이상이면 중심극한정리에 의해 근사적으로 정규성 가정 가능).  
- 두 그룹의 점수 데이터가 독립적이다.  
- 두 그룹의 분산이 유사해야 한다 (등분산 가정, 필요 시 Welch’s T-TEST 사용).
```

> **🔍 Q5. 추가적으로 최신 AI 기반 교육 프로그램(C)도 도입하여 기존 프로그램(B) 및 새로운 프로그램(A)과 비교하여 성취도 차이가 있는지 평가하고자 한다면 어떤 검정 방법을 사용해야 할까요?**

```
ANOVA
```

> **🔍 Q6. 5번에서 답한 검정을 수행한 결과, 유의미한 차이가 나타났다면 추가적으로 어떤 검정을 수행해 볼 수 있을까요?**

```
ANOVA 결과가 유의미하다면, 어떤 그룹 간 차이가 존재하는지 확인하기 위해 사후검정을 수행해야 한다.

# Tukey's HSD Test: 모든 그룹 쌍을 비교하여 차이가 있는지 확인할 때 사용 (집단 크기가 유사할 때 적절).

# Scheffe Test: 집단 크기가 다를 때도 유효한 방법.
```

---

### **문제 3. 카이제곱 검정**  
> **🧚 다음 중 어떠한 경우에 카이제곱 검정을 사용해야 하나요?   
1️⃣ 제품 A, B, C의 평균 매출 차이를 비교하고자 한다.  
2️⃣ 남성과 여성의 신체 건강 점수 평균 차이를 분석한다.  
3️⃣ 제품 구매 여부(구매/미구매)와 고객의 연령대(10대, 20대, 30대…) 간의 연관성을 분석한다.  
4️⃣ 특정 치료법이 환자의 혈압을 감소시키는 효과가 있는지 확인한다.**  

```
답: 3️⃣  
해설:  
- 카이제곱 검정은 두 개 이상의 범주형 변수 간 연관성을 분석하는 기법이다.  
- 1️⃣, 2️⃣는 평균 차이 비교이므로 ANOVA나 t-검정이 적절하며, 4️⃣는 회귀 분석이 더 적합하다. 
```

### 🎉 수고하셨습니다.